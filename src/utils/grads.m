function grad = grads(x)
% *************************************************************************
% * This function calculates the finite differences of an image x.
% *************************************************************************
% * Author : Yunhui Gao
% * Date   : 2021/04/20
% *************************************************************************
%
%   ===== Required inputs =================================================
%
%	- x     : 1D/2D/3D array
%             The input image. 
%
%   ===== Outputs =========================================================
%
%   - grad : 2D/3D/4D array
%            The finite differences of x.
%
% *************************************************************************

[n1,n2,n3] = size(x);
grad = zeros(n1,n2,n3,3);
grad(:,:,:,1) = x - circshift(x,[-1,0,0]);
grad(n1,:,:,1) = 0;
grad(:,:,:,2) = x - circshift(x,[0,-1,0]);
grad(:,n2,:,2) = 0;
grad(:,:,:,3) = x - circshift(x,[0,0,-1]);
grad(:,:,n3,3) = 0;

end

