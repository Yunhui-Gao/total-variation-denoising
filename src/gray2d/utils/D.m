function grad = D(x)
% *************************************************************************
% * This function calculates the finite differences of an image x.
% *************************************************************************
% * Author : Yunhui Gao
% * Date   : 2021/04/20
% *************************************************************************
%
%   ===== Required inputs =================================================
%
%	- x     : 2D array
%             The input image. 
%
%   ===== Outputs =========================================================
%
%   - grad : 3D array
%            The finite differences of x.
%
% *************************************************************************

[n1,n2] = size(x);
grad = zeros(n1,n2,2);
grad(:,:,1) = x - circshift(x,[-1,0]);
grad(n1,:,1) = 0;
grad(:,:,2) = x - circshift(x,[0,-1]);
grad(:,n2,2) = 0;

end

